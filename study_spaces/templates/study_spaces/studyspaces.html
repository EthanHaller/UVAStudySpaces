<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Study Spaces</title>


		<script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
		<script src="https://maps.googleapis.com/maps/api/js?key={{key}}&callback=initMap&v=weekly" defer></script>
		<script>
			let map
			function initMap() {
				map = new google.maps.Map(document.getElementById("map"), {
					center: { lat: 38.03413872243867, lng: -78.50873523191473 },
					zoom: 16,
				})

				const navbarHeight = document.getElementById("global-navbar").offsetHeight
				const mapHeight = `calc(100vh - ${navbarHeight}px)`
				document.getElementById("map-container").style.height = mapHeight

				const modData = JSON.parse("{{ mod_json|escapejs }}")
				const markers = modData.map((i) => {
					const marker = new google.maps.Marker({
						position: { lat: parseFloat(i.latitude), lng: parseFloat(i.longitude) },
						map: map,
					})
					marker.addListener("click", () => {
						map.setZoom(18)
						map.setCenter(marker.getPosition())

						modData.forEach((element) => {
							const card = document.getElementById("study-card-id-" + element.id)
							card.style.backgroundColor = null
						})

						const card = document.getElementById("study-card-id-" + i.id)
						card.style.backgroundColor = "#F5F5F5"
					})
				})
			}
			window.initMap = initMap
		</script>
	</head>
	<body>
		{% include 'study_spaces/navbar.html' %}
		<div class="row" style="width: 100vw">
			<div class="col-sm-8">
				<div id="map-container">
					<div id="map" class="h-100"></div>
				</div>
			</div>
			<div class="col-sm-4">
				<div id="list-container" class="py-4">
					{% block content %} {% for x in mod %}
					<div id="study-card-id-{{x.id}}" class="card mb-3" style="max-width: 540px">
						<div class="row g-0">
							<div class="col-md-4">
								<img src="..." class="img-fluid rounded-start" alt="..." />
							</div>
							<div class="col-md-8">
								<div class="card-body">
									<h5 class="card-title">{{x.name}}</h5>
									<p class="card-text">{{x.address}}</p>
									<a href="{% url 'study_spaces:directions' %}?dest={{ x.id }}" class="btn btn-primary">Get Directions</a>
								</div>
							</div>
						</div>
					</div>
					{% endfor %} {% endblock content %}
				</div>
			</div>
		</div>
	</body>
</html>
